"use strict";const{triggerAsyncId:triggerAsyncId}=require("async_hooks"),{OBSUtility:OBSUtility}=require("nodecg-utility-obs");module.exports=function(nodecg){nodecg.Replicant("brandReplicant",{defaultValue:"danno.nz"});const tickerReplicant=nodecg.Replicant("tickerReplicant",{defaultValue:"danno.nz livestream"}),statsReplicant=nodecg.Replicant("statsReplicant",{defaultValue:{willReshow:!1,willCopyright:!1,copyrightCountdown:0,copyrightShowing:!1,doingCopyright:!1,copyrightDuration:5e3}}),showTicker=nodecg.Replicant("showTicker",{defaultValue:{bool:!0,fromTransition:!1}});nodecg.log.info("hi");var transitionsToHideOn=["Stinger1","Stinger2"],reShowOnNextTransitionEnd=!1;const doTransitionHide=nodecg.Replicant("doTransitionHide",{defaultValue:!1});var excludedScenes=["StartingSoon"];const obs=new OBSUtility(nodecg);obs.on("TransitionBegin",data=>{(transitionsToHideOn.includes(data.name)||excludedScenes.includes(data["to-scene"]))&&(doTransitionHide.value=!0,reShowOnNextTransitionEnd=!0,statsReplicant.value.willReshow=!0)});var copyrightScenes=["Outro"];function copyrightTicker(){var timeToShowCopyright=10;obs.send("GetCurrentScene").then(data=>{if(copyrightScenes.includes(data.name)){showTicker.value={bool:!1,fromTransition:!0},statsReplicant.value.willCopyright=!0,statsReplicant.value.doingCopyright=!0,statsReplicant.value.copyrightCountdown=1e4;var localDoingCopyright=!0,showCopy=setTimeout(()=>{statsReplicant.on("change",value=>{if(0==value.doingCopyright&&1==localDoingCopyright)return clearTimeout(showCopy),clearTimeout(hideCopy),showTicker.value={bool:!1,fromTransition:!0},tickerReplicant.value="",void(localDoingCopyright=!1)}),console.log("Showing copyright"),tickerReplicant.value=`Â©${(new Date).getFullYear()}`,showTicker.value={bool:!0,fromTransition:!0},statsReplicant.value.copyrightShowing=!0;var hideCopy=setTimeout(()=>{console.log("Hiding copyright"),showTicker.value={bool:!1,fromTransition:!0},statsReplicant.value.copyrightShowing=!1,statsReplicant.value.willCopyright=!1,statsReplicant.value.doingCopyright=!1},5e3)},1e4)}})}obs.on("SwitchScenes",data=>{copyrightScenes.includes(data["scene-name"])||1==statsReplicant.value.doingCopyright&&(statsReplicant.value.doingCopyright=!1),excludedScenes.includes(data["scene-name"])?(statsReplicant.value.willReshow=!1,reShowOnNextTransitionEnd=!1,doTransitionHide.value=!0):reShowOnNextTransitionEnd=!0,1==reShowOnNextTransitionEnd&&(copyrightScenes.includes(data["scene-name"])&&copyrightTicker(),doTransitionHide.value=!1,reShowOnNextTransitionEnd=!1,statsReplicant.value.willReshow=!0)})};